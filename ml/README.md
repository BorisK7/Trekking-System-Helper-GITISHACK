# üé¨ Object Tracking & Segmentation Suite

–ù–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ –∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–≤–∏–∂—É—â–∏—Ö—Å—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ —Å –∫—Ä–∞—Å–∏–≤–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π.

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
ml/
‚îú‚îÄ‚îÄ demo_tracker.py           # üöÄ –ë—ã—Å—Ç—Ä—ã–π –¥–µ–º–æ (—Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ ML –±–∏–±–ª–∏–æ—Ç–µ–∫)
‚îú‚îÄ‚îÄ object_tracker.py         # üì¶ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ç—Ä–µ–∫–µ—Ä —Å SAM 2
‚îú‚îÄ‚îÄ interactive_segmentation.py  # üé® –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ sam2_video_tracker.py     # ü§ñ SAM 2 Video Tracking
‚îî‚îÄ‚îÄ requirements.txt          # üìã –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –î–µ–º–æ (–±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)

```bash
cd ml
python demo_tracker.py test.mp4
```

–û–ø—Ü–∏–∏:
- `--pose` - –¥–µ—Ç–µ–∫—Ü–∏—è —Å–∫–µ–ª–µ—Ç–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç ultralytics)
- `--no-panel` - –±–µ–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª–∏
- `-o output.mp4` - –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt

# –î–ª—è SAM 2 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
pip install git+https://github.com/facebookresearch/segment-anything-2.git

# –î–ª—è YOLO-Pose:
pip install ultralytics
```

## üîß –ú–æ–¥—É–ª–∏

### demo_tracker.py
**–ë–∞–∑–æ–≤—ã–π —Ç—Ä–µ–∫–µ—Ä –¥–≤–∏–∂–µ–Ω–∏—è** –Ω–∞ –æ—Å–Ω–æ–≤–µ OpenCV Background Subtraction.

‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏ –±–µ–∑ ML  
‚úÖ –ö—Ä–∞—Å–∏–≤–∞—è –Ω–µ–æ–Ω–æ–≤–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è  
‚úÖ –¢—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è  
‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å  

```bash
python demo_tracker.py video.mp4 -o result.mp4
python demo_tracker.py video.mp4 --pose  # –° –¥–µ—Ç–µ–∫—Ü–∏–µ–π —Å–∫–µ–ª–µ—Ç–æ–≤
```

### object_tracker.py  
**–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ç—Ä–µ–∫–µ—Ä** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π SAM 2 –∏ YOLO-Pose.

```bash
# –° OpenCV (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python object_tracker.py video.mp4

# –° SAM 2
python object_tracker.py video.mp4 -t sam2

# –° –¥–µ—Ç–µ–∫—Ü–∏–µ–π –ø–æ–∑—ã
python object_tracker.py video.mp4 --pose
```

### interactive_segmentation.py
**–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è** - –≤—ã–±–∏—Ä–∞–π –æ–±—ä–µ–∫—Ç—ã –º—ã—à–∫–æ–π!

```bash
python interactive_segmentation.py video.mp4
python interactive_segmentation.py video.mp4 --sam  # –° SAM
```

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
- **–õ–ö–ú** - –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫—É –æ–±—ä–µ–∫—Ç–∞
- **–ü–ö–ú** - –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫—É —Ñ–æ–Ω–∞  
- **N** - –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç
- **D** - —É–¥–∞–ª–∏—Ç—å —Ç–æ—á–∫—É
- **R** - —Å–±—Ä–æ—Å–∏—Ç—å –æ–±—ä–µ–∫—Ç
- **Space** - play/pause
- **S** - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
- **Q** - –≤—ã—Ö–æ–¥

### sam2_video_tracker.py
**SAM 2 Video Predictor** - state-of-the-art —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è.

```bash
python sam2_video_tracker.py video.mp4 --auto  # –ê–≤—Ç–æ–¥–µ—Ç–µ–∫—Ü–∏—è
python sam2_video_tracker.py video.mp4 --interactive  # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä
```

## üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### –ù–µ–æ–Ω–æ–≤—ã–π —Å—Ç–∏–ª—å
- –Ø—Ä–∫–∏–µ —Ü–≤–µ—Ç–∞ —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º —Å–≤–µ—á–µ–Ω–∏—è
- –ó–∞—Ç—É—Ö–∞—é—â–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏
- –°—Ç–∏–ª—å–Ω—ã–µ bounding boxes
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ
- ID –æ–±—ä–µ–∫—Ç–∞
- –°–∫–æ—Ä–æ—Å—Ç—å –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- FPS

## üß† –ú–æ–¥–µ–ª–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏

### SAM 2 (Segment Anything Model 2)
**–õ—É—á—à–∏–π –≤—ã–±–æ—Ä –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤**

- –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π video memory –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤: —Ç–æ—á–∫–∏, boxes, –º–∞—Å–∫–∏

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
pip install git+https://github.com/facebookresearch/segment-anything-2.git
```

### YOLO-Pose
**–î–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –ª—é–¥–µ–π –∏ —Å–∫–µ–ª–µ—Ç–æ–≤**

- –ë—ã—Å—Ç—Ä–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è
- 17 –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫ —Ç–µ–ª–∞
- –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–¥—è—Ö

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
pip install ultralytics
```

### OpenCV Background Subtraction
**–ë–∞–∑–æ–≤—ã–π –º–µ—Ç–æ–¥ –±–µ–∑ ML**

- –†–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç GPU

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

| –ú–µ—Ç–æ–¥ | –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã | –°–∫–æ—Ä–æ—Å—Ç—å | GPU | –ö–∞—á–µ—Å—Ç–≤–æ |
|-------|---------------------|----------|-----|----------|
| SAM 2 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ | –°—Ä–µ–¥–Ω—è—è | –î–∞ | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| YOLO | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –∫–ª–∞—Å—Å—ã | –ë—ã—Å—Ç—Ä–∞—è | –û–ø—Ü. | ‚≠ê‚≠ê‚≠ê‚≠ê |
| OpenCV MOG2 | ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –¥–≤–∏–∂–µ–Ω–∏–µ | –ë—ã—Å—Ç—Ä–∞—è | –ù–µ—Ç | ‚≠ê‚≠ê‚≠ê |

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤** ‚Üí SAM 2
2. **–î–ª—è –ª—é–¥–µ–π/—Å–∫–µ–ª–µ—Ç–æ–≤** ‚Üí YOLO-Pose  
3. **–ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Ç–æ—Ç–∏–ø –±–µ–∑ GPU** ‚Üí OpenCV MOG2
4. **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä** ‚Üí interactive_segmentation.py

## üé• –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
from demo_tracker import DemoProcessor

# –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
processor = DemoProcessor(show_panel=True, use_pose=False)

# –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–∏–¥–µ–æ
processor.process_video(
    input_path='test.mp4',
    output_path='result.mp4',
    show_preview=True
)
```

```python
from object_tracker import VideoProcessor, VisualizationConfig

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
config = VisualizationConfig(
    trail_length=100,
    mask_alpha=0.5,
    glow_effect=True
)

# –û–±—Ä–∞–±–æ—Ç–∫–∞
processor = VideoProcessor(tracker_type='opencv', vis_config=config)
processor.process_video('input.mp4', 'output.mp4')
```

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [SAM 2 GitHub](https://github.com/facebookresearch/segment-anything-2)
- [Ultralytics YOLO](https://docs.ultralytics.com/)
- [OpenCV Documentation](https://docs.opencv.org/)

